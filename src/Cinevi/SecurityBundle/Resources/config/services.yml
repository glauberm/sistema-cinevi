services:
    # Voters
    cinevi.access.admin_user:
        class: Cinevi\SecurityBundle\Authorization\Voter\UserVoter
        public: false
        arguments: ['@security.access.decision_manager']
        tags:
            - { name: security.voter }

    # Forms
    cinevi.form.admin_user:
        class: Cinevi\SecurityBundle\Form\Type\UserType
        arguments: ['@security.authorization_checker','@cinevi.user_validation']
        tags:
            - { name: form.type, alias: view }

    cinevi.form.profile:
        class: Cinevi\SecurityBundle\Form\Type\ProfileType
        tags:
            - { name: form.type, alias: cinevi_profile }

    cinevi.form.registration:
        class: Cinevi\SecurityBundle\Form\Type\RegistrationType
        tags:
            - { name: form.type, alias: cinevi_registration }

    # Validation Groups
    cinevi.user_validation_factory:
        class: Cinevi\SecurityBundle\Validation\UserValidationGroupResolverFactory
        arguments: ['@security.authorization_checker']

    cinevi.user_validation:
        class: Cinevi\SecurityBundle\Validation\UserValidationGroupResolver
        factory: ['@cinevi.user_validation_factory', create]
